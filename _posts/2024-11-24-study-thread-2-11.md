---
title: 11 동시성 컬렉션
date: 2024-11-24 17:00:00 +0900
categories: [Study, Java-advanced1]
tags: [study, java, thread, adv1]
pin: true
---

## 스터디 git 주소
<hr />

- <https://github.com/chj-dev/java-adv1>


## 동시성 컬렉션

- 스레드 세이프(Thread Safe)한 컬렉션.
- 정교한 잠금 메커니즘을 사용하여 동시 접근을 효율적으로 처리하고, 필요한 경우 일부 메서드에만 동기화를 적용하여 유연한 전략을 제공한다.
- 다양한 성능 최적화 기법들을 사용한다: synchronized, Lock (ReentrantLock), CAS, 분할 잠금 기술(segment lock)

### Thread Safe?

- 여러 스레드가 동시에 접근해도 괜찮은 경우를 의미한다.
- 멀티 스레드 환경에서 안전한 것.

### 왜 동시성 컬렉션을 사용할까?

- 컬렉션 프레임워크 대부분은 스레드 세이프하지 않다.
- `ArrayList`, `LinkedList`, `HashSet`, `HashMap` 등 수많은 자료 구조들은 겉보기엔 원자적으로 보이나 내부적으로는 수 많은 연산들이 사용되기 때문에 스레드 세이프하지 않는다.
- ex. 배열에 데이터 추가, 사이즈 변경, 배열을 새로 만들어 배열 크기 늘리기, 노드를 만들어서 링크에 연결 등등..
- 최악의 경우 두 명의 사용자가 동시에 컬렉션에 데이터를 보관했는데, 한 사용자의 데이터가 사라질 수도 있다.
- 그렇다면.. 해당 컬렉션 프레임워크를 복사하여 synchronized 기능만 추가하면 어떨까?

### 프록시(Proxy)

- 모든 소스를 복사하여 synchronized 키워드만 붙여주는 작업은 상당히 비효율적이다.
- 이럴 때 프록시를 사용하면 좋다.
- 대리자, 대신 처리해주는 자 라는 뜻이다.
- 프록시 클래스를 통해 동기화 기능만 붙여주고, 실제 동작을 수행하는 메서드만 호출하는 것이다.
```java
@Override
public synchronized void add(Object e) {
  target.add(e);    //실제 동작을 수행하는 List 의 add 메서드 호출 
}
```

### 프록시 패턴(Proxy Pattern)

- 객체지향 디자인 패턴 중 하나이다.
- 어떤 객체에 대한 접근을 제어하기 위해 그 객체의 대리인 또는 인터페이스 역할을 하는 객체를 제공하는 패턴이다.
- 실제 객체에 대한 참조를 유지하면서, 그 객체에 접근하거나 동작을 수행하기 전에 추가적인 처리를 할 수 있도록 한다.

1. 주요 목적
: **접근 제어**: 실제 객체에 대한 접근을 제어하거나 통제할 수 있다.
: **성능 향상**: 실제 객체의 생성을 지연시키거나 캐싱하여 성능을 최적화할 수 있다.
: **부가 기능 제공**: 실제 객체에 추가적인 기능(로깅, 인증, 동기화 등)을 투명하게 제공할 수 있다.


## 참고자료
<hr />

[김영한의 실전 자바 - 고급 1편](https://www.inflearn.com/course/%EA%B9%80%EC%98%81%ED%95%9C%EC%9D%98-%EC%8B%A4%EC%A0%84-%EC%9E%90%EB%B0%94-%EA%B3%A0%EA%B8%89-1/dashboard)
